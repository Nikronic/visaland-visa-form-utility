# core
import pandas as pd
import numpy as np
import pickle
# ours
from vizard.models import preprocessors
from vizard.models import trainers
# devops
import dvc.api
import mlflow
# demo
import gradio as gr
# helpers
from typing import List


# data versioning config
PATH = 'raw-dataset/all-dev.pkl'
REPO = '/home/nik/visaland-visa-form-utility'
VERSION = 'v1.2.3-dev'  # TODO
# MLFLOW_RUN_ID = 'abe11fab2aca405091ac1d64d8bdc858'
MLFLOW_RUN_ID = 'f0b0f12950b94fde95313f08473bc561'
mlflow.set_tracking_uri('http://localhost:5000')

# read data from DVC storage
#   only need this data for columns to build Gradio interface properly
data_url = dvc.api.get_url(path=PATH, repo=REPO, rev=VERSION)
data: pd.DataFrame = pd.read_pickle(data_url)
# drop Y column
data = data.drop(columns=['VisaResult'])

# load fitted preprocessing models
X_CT_NAME = 'train_sklearn_column_transfer.pkl'
x_ct_path = mlflow.artifacts.download_artifacts(run_id=MLFLOW_RUN_ID,
                                                artifact_path=f'models/{X_CT_NAME}',
                                                dst_path=f'gradio/')
with open(x_ct_path, 'rb') as f:
    x_ct: preprocessors.ColumnTransformer = pickle.load(f)

# load fitted FLAML AutoML model for prediction
FLAML_AUTOML_NAME = 'flaml_automl.pkl'
flaml_automl_path = mlflow.artifacts.download_artifacts(run_id=MLFLOW_RUN_ID,
                                                        artifact_path=f'models/{FLAML_AUTOML_NAME}',
                                                        dst_path=f'gradio/')
with open(flaml_automl_path, 'rb') as f:
    flaml_automl: trainers.AutoML = pickle.load(f)

def predict(*args):
    # convert to dataframe
    x_test = pd.DataFrame(data=[list(args)], columns=data.columns)
    x_test = x_test.astype(data.dtypes)
    x_test = x_test.to_numpy()
    # preprocess test data
    xt_test = x_ct.transform(x_test)
    # predict
    y_pred = flaml_automl.predict_proba(xt_test)
    label = np.argmax(y_pred)
    y_pred = y_pred[0, label]
    y_pred = y_pred if label == 1 else 1. - y_pred
    msg = f'Percentage: {y_pred * 100:.2f}'
    print(msg)
    return msg, y_pred

# build gradio interface given dataframe dtype
inputs: List[gr.components.Component] = []
for col in data.columns:
    if data[col].dtype == 'category':
        inputs.append(gr.Dropdown(choices=list(data[col].unique()),
                                  label=col))
    elif data[col].dtype == 'float32':
        inputs.append(gr.Number(label=col,
                                value=int(data[col].min())))
    elif data[col].dtype == 'int32':
        inputs.append(gr.Slider(minimum=int(data[col].min()),
                                maximum=int(data[col].max()),
                                step=1,
                                label=col,
                                value=int(data[col].min())))
    else:
        raise ValueError(f'Unknown dtype {data[col].dtype} for column {col}')

# prediction probability output
outputs = [
    gr.Textbox(label='Percentage of acceptance'),
    gr.Number(label='Probability'),
]

examples = [
    [False,'Male',1.107154369354248,1,1.429856300354004,1.429856300354004,False,'Georgia',6,False,'tourism',6000.0,'hotel','hotel',False,'unedu',1.0,'employee',1.107154369354248,'OTHER',1.107154369354248,'OTHER',1.107154369354248,False,False,False,46.673973083496094,0.0,0.0,29.0,11.147945404052734,0.0,60.03333282470703,11.0,0.0,11.649314880371094,0.0,0.0,5,9,9,9,'other',9,'other',9,'other',9,'other',5,'sister',5,'sister',5,'brother',9,'other',9,'other',9,'other',9,'other',42.16712188720703,73.93424987792969,70.53150939941406,0.0,0.0,0.0,0.0,50.413700103759766,44.657535552978516,40.40821838378906,0.0,0.0,0.0,0.0,0,0,0,0,0,1,0,0,3,2,0],
    [False,'Male',1.107154369354248,1,1.429856300354004,1.429856300354004,False,'TURKEY',6,True,'visit',10000.0,'hotel','hotel',True,'master',3.1778037548065186,'employee',1.107154369354248,'OTHER',1.107154369354248,'OTHER',1.107154369354248,False,False,False,40.926029205322266,0.0,0.0,30.0,12.178082466125488,7.512328624725342,52.43333435058594,13.0,2.002739667892456,10.904109954833984,0.0,0.0,5,5,5,6,'son',6,'daughter',6,'daughter',9,'other',5,'brother',5,'brother',5,'brother',5,'sister',9,'other',9,'other',9,'other',40.98904037475586,67.6356201171875,67.40547943115234,19.23287582397461,9.805479049682617,2.5671231746673584,0.0,38.92328643798828,37.92328643798828,33.92054748535156,31.920547485351562,0.0,0.0,0.0,0,0,0,0,0,0,0,3,4,3,0],
    [False,'Male',1.107154369354248,1,1.429856300354004,1.429856300354004,False,'TURKEY',3,False,'family visit',8000.0,'f1','ukn',True,'apprentice',3.1778037548065186,'employee',1.107154369354248,'employee',1.107154369354248,'OTHER',1.107154369354248,False,False,True,38.48219299316406,0.0,0.0,31.0,0.0,0.0,39.5,28.0,0.4547945261001587,8.460273742675781,18.46849250793457,0.0,7,5,5,9,'other',9,'other',9,'other',9,'other',5,'sister',5,'sister',5,'brother',5,'sister',5,'sister',9,'other',9,'other',0.0,75.52328491210938,85.0,0.0,0.0,0.0,0.0,55.816436767578125,54.32328796386719,51.28493118286133,49.66301345825195,40.24931335449219,0.0,0.0,0,0,0,0,0,0,0,0,5,2,3],
    [False,'Male',1.107154369354248,1,1.429856300354004,1.429856300354004,False,'TURKEY',6,False,'tourism',6000.0,'hotel','hotel',True,'bachelor',3.1778037548065186,'manager',1.107154369354248,'OTHER',1.107154369354248,'OTHER',1.107154369354248,False,True,True,43.169864654541016,0.0,0.0,29.0,16.2657527923584,0.0,40.099998474121094,13.0,5.002739906311035,15.15068531036377,0.0,0.0,5,9,9,6,'daughter',9,'other',9,'other',9,'other',5,'sister',6,'brother',9,'other',9,'other',9,'other',9,'other',9,'other',40.72054672241211,81.80821990966797,83.09589385986328,9.421917915344238,0.0,0.0,0.0,41.134246826171875,34.868492126464844,0.0,0.0,0.0,0.0,0.0,0,0,0,1,0,1,0,1,2,2,0],
    [False,'Male',1.107154369354248,1,1.429856300354004,1.429856300354004,False,'TURKEY',3,False,'family visit',10000.0,'f1','ukn',True,'diploma',3.1778037548065186,'manager',1.107154369354248,'OTHER',1.107154369354248,'OTHER',1.107154369354248,False,False,True,84.82740020751953,0.0,0.0,92.0,56.69314956665039,0.0,12.166666984558105,0.0,2.002739667892456,17.78356170654297,0.0,0.0,5,9,9,5,'son',5,'daughter',5,'son',9,'other',7,'sister',9,'other',9,'other',9,'other',9,'other',9,'other',9,'other',72.03287506103516,111.86849212646484,120.2273941040039,54.66849136352539,51.123287200927734,41.55342483520508,0.0,89.93972778320312,0.0,0.0,0.0,0.0,0.0,0.0,0,0,0,0,0,1,0,3,1,0,2],
    [False,'Female',1.107154369354248,1,1.429856300354004,1.429856300354004,False,'TURKEY',3,False,'family visit',10000.0,'f1','ukn',True,'diploma',3.1778037548065186,'retired',1.107154369354248,'employee',1.107154369354248,'OTHER',1.107154369354248,False,False,True,71.81917572021484,0.0,0.0,92.0,56.69314956665039,0.0,12.166666984558105,0.0,2.0,13.780821800231934,10.00547981262207,0.0,5,7,9,5,'son',5,'daughter',5,'son',9,'other',5,'brother',5,'sister',5,'brother',5,'sister',9,'other',9,'other',9,'other',84.30684661865234,85.0,85.0,54.66849136352539,51.123287200927734,41.55342483520508,0.0,62.27945327758789,67.22191619873047,59.05479431152344,56.843833923339844,0.0,0.0,0.0,0,0,0,0,0,1,0,3,4,0,2],
    [False,'Female',1.107154369354248,1,1.429856300354004,1.429856300354004,False,'TURKEY',3,False,'tourism',10000.0,'hotel','hotel',False,'unedu',1.0,'housewife',1.107154369354248,'OTHER',1.107154369354248,'OTHER',1.107154369354248,False,False,False,35.26849365234375,0.0,0.0,30.0,11.542466163635254,0.0,39.56666564941406,13.0,0.0,11.252055168151855,0.0,0.0,5,7,5,6,'son',9,'other',9,'other',9,'other',5,'brother',5,'sister',5,'brother',6,'brother',6,'brother',6,'brother',5,'sister',45.210960388183594,65.52877044677734,71.72876739501953,1.238356113433838,0.0,0.0,0.0,46.29315185546875,43.99177932739258,43.5123291015625,32.56438446044922,36.00822067260742,32.9068489074707,30.868494033813477,0,0,0,1,0,1,0,1,7,8,0],
    [False,'Male',1.107154369354248,1,1.429856300354004,1.429856300354004,False,'TURKEY',3,False,'family visit',10000.0,'f1','ukn',True,'bachelor',3.1778037548065186,'manager',1.107154369354248,'OTHER',1.107154369354248,'OTHER',1.107154369354248,False,False,True,37.47671127319336,0.0,0.0,30.0,0.0,0.0,53.099998474121094,21.0,4.002739906311035,4.454794406890869,0.0,0.0,5,5,5,9,'other',9,'other',9,'other',9,'other',5,'sister',9,'other',9,'other',9,'other',9,'other',9,'other',9,'other',0.0,69.35342407226562,69.08493041992188,0.0,0.0,0.0,0.0,41.70410919189453,0.0,0.0,0.0,0.0,0.0,0.0,0,0,0,0,0,0,0,0,1,1,0],
    [False,'Male',1.107154369354248,1,1.429856300354004,1.429856300354004,False,'TURKEY',3,False,'tourism',10000.0,'hotel','hotel',True,'master',3.1778037548065186,'manager',1.107154369354248,'manager',1.107154369354248,'manager',1.107154369354248,False,False,False,35.367122650146484,0.0,0.0,31.0,1.917808175086975,0.0,39.29999923706055,16.0,2.002739667892456,2.345205545425415,3.0,4.002739906311035,5,5,5,9,'other',9,'other',9,'other',9,'other',5,'sister',5,'sister',5,'brother',5,'brother',5,'sister',5,'sister',9,'other',34.1424674987793,74.05205535888672,84.1616439819336,0.0,0.0,0.0,0.0,53.852054595947266,51.84931564331055,48.84657669067383,46.84657669067383,44.843833923339844,33.838356018066406,0.0,0,0,0,0,0,1,0,0,6,8,0],
    [False,'Female',1.107154369354248,1,1.429856300354004,1.429856300354004,False,'TURKEY',6,True,'tourism',8000.0,'hotel','hotel',True,'master',3.1778037548065186,'employee',1.107154369354248,'employee',1.107154369354248,'employee',1.107154369354248,False,True,False,47.6301383972168,0.0,0.0,90.0,11.265753746032715,8.75068473815918,60.43333435058594,12.0,6.002739906311035,3.5999999046325684,2.002739667892456,7.002739906311035,5,5,5,6,'step,son',6,'daughter',6,'daughter',9,'other',5,'sister',6,'brother',9,'other',9,'other',9,'other',9,'other',9,'other',47.77808380126953,68.84109497070312,78.15616607666016,18.832876205444336,4.509589195251465,18.416439056396484,0.0,46.93698501586914,35.20273971557617,0.0,0.0,0.0,0.0,0.0,0,0,0,1,0,1,0,3,2,2,2],
    [False,'Female',1.107154369354248,1,1.429856300354004,1.429856300354004,False,'TURKEY',3,False,'tourism',10000.0,'hotel','hotel',True,'master',3.1778037548065186,'manager',1.107154369354248,'OTHER',1.107154369354248,'OTHER',1.107154369354248,False,False,True,47.134246826171875,0.0,0.0,92.0,25.854795455932617,0.0,60.66666793823242,16.0,2.002739667892456,11.109588623046875,0.0,0.0,5,9,9,6,'daughter',9,'other',9,'other',9,'other',5,'sister',5,'sister',5,'sister',9,'other',9,'other',9,'other',9,'other',55.71506881713867,71.93424987792969,79.81095886230469,19.28219223022461,0.0,0.0,0.0,51.96164321899414,48.26849365234375,38.95068359375,0.0,0.0,0.0,0.0,0,0,0,1,0,1,0,1,3,2,1],
    [False,'Male',1.107154369354248,1,1.429856300354004,1.429856300354004,False,'Georgia',6,False,'family visit',10000.0,'f1','ukn',False,'unedu',1.0,'manager',1.107154369354248,'OTHER',1.107154369354248,'OTHER',1.107154369354248,False,False,False,56.657535552978516,0.0,0.0,30.0,30.624656677246094,0.0,42.83333206176758,30.0,0.0,6.621917724609375,0.0,0.0,5,5,5,6,'daughter',6,'daughter',9,'other',9,'other',5,'brother',5,'sister',5,'sister',9,'other',9,'other',9,'other',9,'other',52.22465896606445,81.76985931396484,85.0,29.2219181060791,25.939725875854492,0.0,0.0,59.10137176513672,58.23835754394531,38.887672424316406,0.0,0.0,0.0,0.0,0,0,0,0,0,1,0,2,3,2,3],
    [False,'Male',1.107154369354248,1,1.429856300354004,1.429856300354004,False,'TURKEY',6,False,'tourism',8000.0,'hotel','hotel',True,'bachelor',3.1778037548065186,'specialist',1.107154369354248,'specialist',1.107154369354248,'OTHER',1.107154369354248,False,False,False,38.0,0.0,0.0,92.0,1.3178082704544067,0.0,60.63333511352539,13.0,4.002739906311035,0.9726027250289917,3.0,0.0,5,5,5,9,'other',9,'other',9,'other',9,'other',5,'sister',5,'brother',5,'sister',9,'other',9,'other',9,'other',9,'other',31.1972599029541,61.649314880371094,63.852054595947266,0.0,0.0,0.0,0.0,39.99452209472656,32.378082275390625,28.98904037475586,0.0,0.0,0.0,0.0,0,0,0,0,0,1,0,0,3,0,1],
    [False,'Female',1.107154369354248,1,1.429856300354004,1.429856300354004,False,'TURKEY',3,False,'family visit',10000.0,'f1','ukn',True,'master',3.1778037548065186,'manager',1.107154369354248,'specialist',1.107154369354248,'OTHER',1.107154369354248,False,False,False,48.610958099365234,0.0,0.0,31.0,17.093151092529297,0.0,58.46666717529297,20.0,3.002739667892456,6.583561420440674,7.005479335784912,0.0,5,5,5,6,'daughter',6,'daughter',9,'other',9,'other',6,'brother',5,'sister',5,'sister',5,'sister',6,'sister',5,'sister',9,'other',47.624656677246094,73.13972473144531,71.54520416259766,13.652054786682129,5.063013553619385,0.0,0.0,37.50959014892578,47.60274124145508,45.29315185546875,42.53424835205078,41.53424835205078,31.690410614013672,0.0,0,0,0,2,0,0,0,2,6,2,2],
    [False,'Female',1.107154369354248,1,2.0999927520751953,1.429856300354004,True,'TURKEY',6,False,'family visit',10000.0,'f1','ukn',True,'bachelor',3.468562126159668,'housewife',1.107154369354248,'OTHER',1.107154369354248,'OTHER',1.107154369354248,False,False,True,60.56438446044922,1876.0,0.0,30.0,43.328765869140625,0.0,59.83333206176758,31.0,5.002739906311035,43.55342483520508,0.0,0.0,5,9,7,6,'daughter',6,'daughter',6,'son',9,'daughter',3,'sister',5,'brother',6,'brother',9,'other',9,'other',9,'other',9,'other',71.29315185546875,85.0,85.0,41.912330627441406,36.430137634277344,36.430137634277344,38.430137634277344,68.55890655517578,66.40274047851562,63.868492126464844,0.0,0.0,0.0,0.0,1,0,0,0,0,0,0,4,3,0,3],
    [False,'Male',1.107154369354248,1,1.429856300354004,1.429856300354004,False,'TURKEY',1,False,'tourism',6000.0,'hotel','hotel',False,'unedu',1.0,'employee',1.107154369354248,'OTHER',1.107154369354248,'OTHER',1.107154369354248,False,True,True,37.621917724609375,0.0,0.0,31.0,15.550684928894043,0.0,48.266666412353516,12.0,0.0,3.5972602367401123,0.0,0.0,5,7,9,6,'son',9,'other',9,'other',9,'other',9,'other',9,'other',9,'other',9,'other',9,'other',9,'other',9,'other',35.72054672241211,0.0,0.0,13.884931564331055,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0,0,0,0,0,0,0,1,0,0,0],
    [False,'Female',1.107154369354248,1,1.429856300354004,1.429856300354004,False,'TURKEY',3,False,'family visit',10000.0,'f1','ukn',True,'master',3.1778037548065186,'specialist',1.107154369354248,'student',1.107154369354248,'student',1.107154369354248,False,False,False,38.68767166137695,0.0,0.0,28.0,12.331506729125977,0.0,59.79999923706055,41.0,2.002739667892456,0.6602739691734314,2.002739667892456,1.0,5,5,5,6,'daughter',9,'other',9,'other',9,'other',7,'brother',5,'sister',9,'other',9,'other',9,'other',9,'other',9,'other',46.31232833862305,66.60822296142578,68.95068359375,7.134246349334717,0.0,0.0,0.0,41.00547790527344,31.926027297973633,0.0,0.0,0.0,0.0,0.0,0,0,0,1,0,1,0,1,2,1,1],
    [False,'Male',1.107154369354248,1,1.429856300354004,1.429856300354004,False,'TURKEY',3,False,'tourism',10000.0,'hotel','hotel',True,'master',3.1778037548065186,'specialist',1.107154369354248,'specialist',1.107154369354248,'specialist',1.107154369354248,False,False,True,53.624656677246094,0.0,0.0,31.0,23.443836212158203,0.0,53.83333206176758,21.0,1.0,1.5890411138534546,15.010958671569824,5.002739906311035,5,7,5,6,'son',6,'son',9,'other',9,'other',5,'sister',5,'sister',5,'brother',5,'sister',9,'other',9,'other',9,'other',47.4630126953125,76.18356323242188,83.20548248291016,20.082191467285156,14.660273551940918,0.0,0.0,59.81917953491211,57.49589157104492,51.4438362121582,45.73150634765625,0.0,0.0,0.0,0,0,0,0,0,1,0,2,4,1,0],
    [False,'Female',1.107154369354248,1,1.429856300354004,1.429856300354004,False,'TURKEY',6,False,'visit',10000.0,'hotel','hotel',True,'bachelor',3.1778037548065186,'employee',1.107154369354248,'OTHER',1.107154369354248,'OTHER',1.107154369354248,False,False,False,32.92054748535156,0.0,0.0,31.0,0.0,0.0,60.599998474121094,6.0,5.002739906311035,1.898630142211914,0.0,0.0,7,5,5,9,'other',9,'other',9,'other',9,'other',6,'brother',5,'brother',5,'brother',5,'brother',5,'brother',9,'other',9,'other',0.0,75.15616607666016,85.0,0.0,0.0,0.0,0.0,37.69041061401367,55.673973083496094,52.17808151245117,55.841094970703125,52.39725875854492,0.0,0.0,0,0,0,0,0,0,0,0,5,0,0],
    [False,'Female',1.107154369354248,1,1.429856300354004,1.429856300354004,False,'TURKEY',6,False,'tourism',10000.0,'hotel','hotel',True,'master',3.1778037548065186,'housewife',1.107154369354248,'OTHER',1.107154369354248,'OTHER',1.107154369354248,False,False,False,41.52328872680664,0.0,0.0,31.0,17.24657440185547,0.0,57.13333511352539,14.0,3.002739667892456,17.50684928894043,0.0,0.0,5,5,5,6,'daughter',6,'son',9,'other',9,'other',6,'brother',6,'brother',9,'other',9,'other',9,'other',9,'other',9,'other',42.28219223022461,64.57260131835938,65.31233215332031,13.320548057556152,4.073972702026367,0.0,0.0,36.65205383300781,30.28219223022461,0.0,0.0,0.0,0.0,0.0,0,0,0,2,0,1,0,2,2,2,2],
    [False,'Female',1.107154369354248,1,2.0999927520751953,1.429856300354004,False,'TURKEY',3,True,'tourism',10000.0,'hotel','hotel',True,'master',3.1778037548065186,'employee',1.107154369354248,'employee',1.107154369354248,'OTHER',1.107154369354248,False,True,True,48.42465591430664,163.0,0.0,30.0,0.0,12.745205879211426,42.63333511352539,13.0,3.002739667892456,11.399999618530273,8.00547981262207,0.0,3,3,9,9,'other',9,'other',9,'other',9,'other',6,'brother',9,'other',9,'other',9,'other',9,'other',9,'other',9,'other',0.0,84.35890197753906,85.0,0.0,0.0,0.0,0.0,44.24109649658203,0.0,0.0,0.0,0.0,0.0,0.0,1,0,0,0,0,0,0,0,1,0,1],
    [False,'Female',1.107154369354248,1,1.429856300354004,1.429856300354004,False,'TURKEY',1,False,'tourism',8000.0,'hotel','hotel',True,'apprentice',3.1778037548065186,'student',1.107154369354248,'OTHER',1.107154369354248,'OTHER',1.107154369354248,False,False,False,22.26849365234375,0.0,0.0,30.0,0.0,0.0,60.79999923706055,13.0,0.25205478072166443,14.26301383972168,0.0,0.0,7,5,5,9,'other',9,'other',9,'other',9,'other',5,'brother',9,'other',9,'other',9,'other',9,'other',9,'other',9,'other',0.0,57.405479431152344,56.928768157958984,0.0,0.0,0.0,0.0,28.48493194580078,0.0,0.0,0.0,0.0,0.0,0.0,0,0,0,0,2,0,0,0,1,0,0],
    [False,'Male',1.107154369354248,1,1.429856300354004,1.429856300354004,False,'TURKEY',6,False,'visit',10000.0,'friend','ukn',False,'unedu',1.0,'OTHER',1.107154369354248,'OTHER',1.107154369354248,'OTHER',1.107154369354248,False,False,False,46.98356246948242,0.0,0.0,30.0,20.687671661376953,0.0,50.733333587646484,14.0,0.0,0.0,0.0,0.0,5,7,9,6,'son',9,'other',9,'other',9,'other',5,'sister',5,'sister',6,'sister',9,'other',9,'other',9,'other',9,'other',42.02191925048828,0.0,0.0,16.657533645629883,0.0,0.0,0.0,42.92328643798828,31.799999237060547,29.74794578552246,0.0,0.0,0.0,0.0,0,0,0,0,0,1,0,1,3,1,0],
    [False,'Female',1.107154369354248,1,1.429856300354004,1.429856300354004,False,'TURKEY',3,False,'family visit',8000.0,'f1','ukn',False,'unedu',1.0,'housewife',1.107154369354248,'OTHER',1.107154369354248,'OTHER',1.107154369354248,False,False,False,61.96986389160156,0.0,0.0,92.0,46.427398681640625,0.0,60.5,28.0,0.0,46.95890426635742,0.0,0.0,5,7,9,5,'son',5,'daughter',5,'daughter',5,'daughter',5,'sister',5,'sister',9,'other',9,'other',9,'other',9,'other',9,'other',73.62739562988281,77.91506958007812,85.0,44.78082275390625,43.802738189697266,39.06575393676758,37.75616455078125,57.405479431152344,55.67671203613281,0.0,0.0,0.0,0.0,0.0,0,0,0,0,0,1,0,4,2,5,0],
    [False,'Female',1.107154369354248,1,1.429856300354004,1.429856300354004,False,'TURKEY',3,False,'tourism',8000.0,'hotel','hotel',True,'master',3.1778037548065186,'manager',1.107154369354248,'OTHER',1.107154369354248,'OTHER',1.107154369354248,False,False,True,56.54794692993164,0.0,0.0,90.0,34.912330627441406,0.0,60.43333435058594,12.0,3.0,23.52602767944336,0.0,0.0,5,5,5,6,'daughter',6,'daughter',9,'other',9,'other',5,'brother',6,'brother',5,'sister',5,'sister',5,'sister',9,'other',9,'other',59.3698616027832,74.79451751708984,85.0,30.46849250793457,22.890411376953125,0.0,0.0,51.96164321899414,43.55068588256836,55.03013610839844,50.172603607177734,52.939727783203125,0.0,0.0,0,0,0,0,0,1,0,2,5,0,1],
    [False,'Male',1.107154369354248,1,1.429856300354004,1.429856300354004,False,'TURKEY',6,False,'visit',10000.0,'work','hotel',True,'bachelor',3.1778037548065186,'employee',1.107154369354248,'OTHER',1.107154369354248,'OTHER',1.107154369354248,False,True,True,38.583560943603516,0.0,0.0,31.0,0.0,0.0,60.5,29.0,4.002739906311035,15.567123413085938,0.0,0.0,7,5,5,9,'other',9,'other',9,'other',9,'other',6,'brother',5,'brother',6,'brother',9,'other',9,'other',9,'other',9,'other',0.0,58.52328872680664,63.084930419921875,0.0,0.0,0.0,0.0,35.4438362121582,33.00822067260742,30.27671241760254,0.0,0.0,0.0,0.0,0,0,0,0,0,0,0,0,3,5,0],
    [False,'Male',1.107154369354248,1,1.429856300354004,1.429856300354004,False,'TURKEY',3,False,'tourism',10000.0,'hotel','hotel',True,'bachelor',3.1778037548065186,'employee',1.107154369354248,'OTHER',1.107154369354248,'OTHER',1.107154369354248,False,False,False,52.646575927734375,0.0,0.0,31.0,25.94794464111328,0.0,60.56666564941406,16.0,5.002739906311035,19.624656677246094,0.0,0.0,5,5,5,6,'daughter',6,'son',9,'other',9,'other',5,'sister',5,'brother',5,'sister',5,'brother',5,'brother',5,'sister',5,'brother',53.890411376953125,76.82191467285156,82.09040832519531,22.44931411743164,14.698630332946777,0.0,0.0,54.893150329589844,50.558902740478516,47.60274124145508,44.380821228027344,42.46027374267578,39.378082275390625,35.375343322753906,0,0,0,0,0,0,0,2,7,7,0],
    [False,'Female',1.107154369354248,1,1.429856300354004,1.429856300354004,False,'TURKEY',3,False,'family visit',9000.0,'f2','ukn',True,'bachelor',3.1778037548065186,'specialist',1.107154369354248,'specialist',1.107154369354248,'specialist',1.107154369354248,False,False,False,27.23287582397461,0.0,0.0,30.0,0.0,0.0,60.93333435058594,26.0,4.002739906311035,2.2164382934570312,2.0,1.0,7,5,5,9,'other',9,'other',9,'other',9,'other',6,'brother',9,'other',9,'other',9,'other',9,'other',9,'other',9,'other',0.0,0.0,0.0,0.0,0.0,0.0,0.0,34.19178009033203,0.0,0.0,0.0,0.0,0.0,0.0,0,0,0,0,0,0,0,0,1,1,0],
    [False,'Female',1.107154369354248,1,1.429856300354004,1.429856300354004,False,'TURKEY',3,True,'family visit',8000.0,'f1','ukn',False,'unedu',1.0,'housewife',1.107154369354248,'OTHER',1.107154369354248,'OTHER',1.107154369354248,False,False,False,76.48493194580078,0.0,0.0,30.0,0.0,57.454795837402344,57.36666488647461,166.0,0.0,58.47397232055664,0.0,0.0,8,9,9,7,'daughter',5,'son',5,'daughter',9,'other',7,'sister',9,'other',9,'other',9,'other',9,'other',9,'other',9,'other',0.0,103.5260238647461,111.88493347167969,57.00547790527344,54.939727783203125,48.69041061401367,0.0,80.54246520996094,0.0,0.0,0.0,0.0,0.0,0.0,0,0,0,0,0,0,0,3,1,3,0],
    [False,'Female',1.107154369354248,1,1.429856300354004,1.429856300354004,False,'TURKEY',6,False,'family visit',5000.0,'f1','ukn',False,'unedu',1.0,'housewife',1.107154369354248,'OTHER',1.107154369354248,'OTHER',1.107154369354248,False,True,True,62.6301383972168,0.0,0.0,90.0,39.80548095703125,0.0,39.20000076293945,33.0,0.0,39.61369705200195,0.0,0.0,5,7,9,5,'daughter',5,'son',5,'son',9,'other',5,'sister',5,'brother',5,'brother',5,'sister',5,'brother',9,'other',9,'other',66.7479476928711,84.71232604980469,85.0,34.830135345458984,32.367122650146484,27.090410232543945,0.0,65.8383560180664,64.35890197753906,60.89862823486328,55.95890426635742,54.6301383972168,0.0,0.0,0,0,1,0,0,1,0,3,5,1,3],

]

title = 'Vizard'
description = 'Vizard is a tool for predicting the chance of obtaining a visa.'

# close all Gradio instances
gr.close_all()

# launch gradio
gr.Interface(
    fn=predict,
    inputs=inputs,
    outputs=outputs,
    examples=examples,
    title=title,
    description=description,
    flagging_dir='gradio/flags',
    analytics_enabled=True,
).launch(debug=True, enable_queue=True, server_port=7860)
